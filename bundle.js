"use strict";function pathSet(t,n,e){var o=_extends({},e);return t.reduce(function(e,o,r){return e[o]=e[o]||{},t.length===r+1&&(e[o]=n),e[o]},o),o}function atom(t,n){function e(){for(var n=arguments.length,e=o(),f=0;f<n;f++)e=r(t,arguments[f],e);u(e)&&i(e)}function o(){return"object"===(void 0===a?"undefined":_typeof(a))?Object.hasOwnProperty("assign")?Object.assign({},a):JSON.parse(JSON.stringify(a)):a}function r(t,n,e){for(var o=e,r=void 0,i=0;i<c;i++)u(r=t[i](n,o))&&(o=r);return o}function i(t){a=t;for(var n=0;n<s.length;n++)s[n]()}function u(t){if(void 0===t)throw new f("Reducer must return a value.");if("function"==typeof t.then)throw new f("Reducer cannot return a Promise.");if("function"!=typeof t)return!0;t(e)}function f(t){this.message=t,this.name="AtomException",this.toString=function(){return this.name+": "+this.message}}t&&void 0===n?(n=t,t=[]):"function"==typeof t&&(t=[t]),t.push(function(t,n){var e=t.type,o=t.payload;switch(e){case"ATOM_SET":return pathSet(o.path,o.value,n);default:return n}});var c=t.length,s=[],a=n;return{dispatch:e,subscribe:function(t){if("function"!=typeof t)throw new f("listener must be a function");s.push(t)},unsubscribe:function(t){if(t){var n=s.length;if(0!==n){console.log("unsubscribe",s);for(var e=0;e<n;e++)t===s[e]&&s.splice(e,1);console.log("unsubscribe",s)}}},getState:o}}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_extends=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};module.exports=atom;
